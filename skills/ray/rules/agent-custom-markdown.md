---
name: agent-custom-markdown
description: How to send Markdown to Ray for agent output
metadata:
  tags: agent, markdown, payload, custom
---

## Agent Custom Markdown Payload

The agent custom Markdown payload renders Markdown content with full formatting support in Ray.

### When to Use

Use the agent custom Markdown payload when you want to:

- Display structured text with Markdown formatting
- Show documentation, reports, or explanations
- Render content with headings, lists, code blocks, tables, and links
- Output LLM/agent responses in a readable format

### Payload Structure

```json
{
  "type": "ai_custom_markdown",
  "content": {
    "markdown": "# Hello World\n\nThis is **bold** and this is *italic*.",
    "label": "Agent Response"
  },
  "origin": {
    "function_name": "code-agent",
    "file": "code-agent",
    "line_number": 1,
    "hostname": "my-computer"
  }
}
```

### Content Fields

| Field      | Type   | Required | Description                                        |
| ---------- | ------ | -------- | -------------------------------------------------- |
| `markdown` | string | Yes      | Valid Markdown content to render.                  |
| `label`    | string | No       | Label for the log entry (e.g., "Claude Response"). |

### Supported Markdown Features

- **Headings** (`#`, `##`, `###`, etc.)
- **Bold** (`**text**`) and _italic_ (`*text*`)
- **Lists** (ordered and unordered)
- **Code blocks** (fenced with ```) with syntax highlighting
- **Inline code** (backticks)
- **Tables**
- **Links** and images
- **Blockquotes**
- **Horizontal rules**

### HTTP API Examples

#### Basic Markdown

```bash
curl -X POST http://localhost:23517/ \
  -H "Content-Type: application/json" \
  -d '{"uuid":"'$(uuidgen)'","payloads":[{"type":"ai_custom_markdown","content":{"markdown":"# Status Update\n\nEverything is working **correctly**.\n\n- Task 1: Complete\n- Task 2: In progress\n- Task 3: Pending","label":"Agent Response"},"origin":{"function_name":"code-agent","file":"code-agent","line_number":1,"hostname":"'$(hostname)'"}}],"meta":{}}'
```

#### Code Documentation

````bash
curl -X POST http://localhost:23517/ \
  -H "Content-Type: application/json" \
  -d '{"uuid":"'$(uuidgen)'","payloads":[{"type":"ai_custom_markdown","content":{"markdown":"## Function: `calculateTotal`\n\nCalculates the total price including tax.\n\n### Parameters\n\n| Name | Type | Description |\n|------|------|-------------|\n| `items` | `array` | List of items |\n| `taxRate` | `number` | Tax rate (0-1) |\n\n### Example\n\n```javascript\nconst total = calculateTotal(items, 0.08);\n```","label":"Documentation"},"origin":{"function_name":"code-agent","file":"code-agent","line_number":1,"hostname":"'$(hostname)'"}}],"meta":{}}'
````

#### Analysis Report

```bash
curl -X POST http://localhost:23517/ \
  -H "Content-Type: application/json" \
  -d '{"uuid":"'$(uuidgen)'","payloads":[{"type":"ai_custom_markdown","content":{"markdown":"# Code Analysis Report\n\n## Summary\nAnalyzed 15 files with 3 issues found.\n\n## Issues\n\n### 1. Unused variable\n> Line 42: `const temp` is declared but never used.\n\n### 2. Missing error handling\nThe `fetchData` function does not handle network errors.\n\n---\n\n*Generated by code analyzer*","label":"Claude Response"},"origin":{"function_name":"code-agent","file":"code-agent","line_number":1,"hostname":"'$(hostname)'"}}],"meta":{}}'
```

### MCP Tool

When using the Ray MCP server, you can use the `send_custom_markdown_output` tool.

**Tool name:** `send_custom_markdown_output`

| Parameter     | Type   | Required | Description                       |
| ------------- | ------ | -------- | --------------------------------- |
| `markdown`    | string | Yes      | Valid Markdown content to render. |
| `projectName` | string | Yes      | The Ray project name.             |
| `llmName`     | string | No       | Name of the LLM for labeling.     |
| `hostname`    | string | No       | The hostname.                     |

### When to Use Markdown vs HTML

| Use Markdown           | Use HTML               |
| ---------------------- | ---------------------- |
| Text-heavy content     | Complex layouts        |
| Documentation          | Custom styling         |
| Code explanations      | Visual mockups         |
| Reports and summaries  | Precise control needed |
| Quick formatted output | Interactive elements   |
